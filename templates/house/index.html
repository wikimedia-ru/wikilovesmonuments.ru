{% extends "base.html" %}

{% block head %}
{% endblock %}

{% block title %}{% endblock %}

{% block content %}
<div class="row">
	<div class="span3">
		<div class="btn-group">
			<a class="btn span2 dropdown-toggle btn-info btn-large" id="findRegionBtn" data-toggle="dropdown" href="#">
				Регион
				<span class="caret"></span>
			</a>
			<ul class="dropdown-menu">
			{% for region in regions %}
				<li><a href="#" data-id="{{ region.id }}" data-coord="{{ region.long }},{{ region.lat }}">{{ region.name }}</a></li>
			{% endfor %}
			</ul>
		</div>
		<br />
		<div class="btn-group">
			<a class="btn span2 dropdown-toggle btn-large" data-toggle="dropdown" href="#">
				Город
				<span class="caret"></span>
			</a>
			<ul class="dropdown-menu">
			{% for region in regions %}
				<li><a href="#" data-id="{{ region.id }}" data-coord="{{ region.long }},{{ region.lat }}">{{ region.name }}</a></li>
			{% endfor %}
			</ul>
		</div>
		<br />
		<div class="btn-group">
			<a class="btn dropdown-toggle span2 btn-large" data-toggle="dropdown" href="#">
				Улица
				<span class="caret"></span>
			</a>
			<ul class="dropdown-menu">
			{% for region in regions %}
				<li><a href="#" data-id="{{ region.id }}" data-coord="{{ region.long }},{{ region.lat }}">{{ region.name }}</a></li>
			{% endfor %}
			</ul>
		</div>
	</div>

	<div class="span9">
		<div class="controls">
			<div class="input-append">
				<input class="span7" id="appendedInputButtons" placeholder="Введите название памятника" size="16" type="text"><button class="btn pull-right" id="monumentSearchBtn" type="button"><i class="icon-search"></i> Найти памятник</button>
			</div>
		</div>

		<div id="map" class="map map-big"></div>
		<script type="text/javascript">
			var cmUrl = 'http://{s}.tile.cloudmade.com/{{ CMADE_KEY }}/997/256/{z}/{x}/{y}.png';
			var cmAttr = 'карта &copy; OpenStreetMap, рендер &copy; CloudMade';
			var map = new L.Map('map');
			map
				.setView(new L.LatLng(66, 94), 3)
				.addLayer(new L.TileLayer(cmUrl, { maxZoom: 18, attribution: cmAttr }));
			var clusterer = new LeafClusterer(map);

			var markers = [];
		{% for house in house_list %}
			markers.push(new L.Marker(new L.LatLng({{ house.coord_lat|stringformat:"f" }}, {{ house.coord_lon|stringformat:"f" }})).bindPopup('<p><a href="/house/{{ house.id }}">{{ house.street.name }}, {{ house.number }}</p>'));
		{% endfor %}
			clusterer.addMarkers(markers);
		</script>
		<h3>Найденные фотографии</h3>
		{{ time }}<br />{{ elapsed_h }}<br />{{ elapsed_p }}
                <ul class="thumbnails" id="foundThumbs">
		{% for photo in photo_list %}
                        <li class="span1">
                                <a href="/house/{{ photo.house.id }}" class="thumbnail"><img src="{{ photo.file.src }}" alt="" /></a>
                        </li>
                {% endfor %}
                </ul>
		
	</div>
	
	<div class="span3 offset3">
		<h3>Наиболее популярные</h3>
		<ul>
		{% for photo in photo_list %}
                        <li>
                                <a href="/house/{{ photo.house.id }}" >{{ photo.house.name }}</a>
                        </li>
                {% endfor %}
                </ul>
	</div>
	<div class="span3">
		<h3>Самые новые</h3>
		<ul>
		{% for photo in photo_list %}
                        <li>
                                <a href="/house/{{ photo.house.id }}" >{{ photo.house.name }}</a>
                        </li>
                {% endfor %}
                </ul>
	</div>
	<div class="span3">
		<h3>Без оценки</h3>
		<ul>
		{% for photo in photo_list %}
                        <li>
                                <a href="/house/{{ photo.house.id }}" >{{ photo.house.name }}</a>
                        </li>
                {% endfor %}
                </ul>
	</div>
</div>
{% endblock %}
